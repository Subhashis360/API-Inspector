<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Inspector Pro - HTTP Requests</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/httprequestpage.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="logo-area">
                <div class="logo-icon">‚ö°</div>
                <div class="logo-text">API Inspector</div>
            </div>

            <nav class="nav-menu">
                <a href="httprequestpage.html" class="nav-item active">
                    <span class="nav-icon">üì°</span>
                    <span class="nav-label">HTTP Requests</span>
                    <span class="nav-badge" id="apiCount">0</span>
                </a>
                <a href="webshoketpage.html" class="nav-item">
                    <span class="nav-icon">üîå</span>
                    <span class="nav-label">WebSockets</span>
                    <span class="nav-badge" id="wsCount">0</span>
                </a>
                <a href="repeterpage.html" class="nav-item">
                    <span class="nav-icon">üîÅ</span>
                    <span class="nav-label">Repeater</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="connection-status">
                    <div class="status-dot"></div>
                    <span id="connectionStatus">Connected</span>
                </div>
                <div class="action-buttons">
                    <button class="icon-btn" id="importBtn" title="Import">üì§</button>
                    <button class="icon-btn" id="exportBtn" title="Export">üì•</button>
                    <button class="icon-btn danger" id="clearBtn" title="Clear All">üóëÔ∏è</button>
                </div>
                <input type="file" id="importInput" accept=".json" style="display: none;">
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar" id="topBar">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search in requests...">
                    <span class="search-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                    </span>
                    <div class="search-nav" id="searchNav" style="display: none;">
                        <span class="search-counter" id="searchCounter">0/0</span>
                        <button class="search-nav-btn" id="searchPrevBtn" title="Previous match (Shift+Enter)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="18 15 12 9 6 15"></polyline>
                            </svg>
                        </button>
                        <button class="search-nav-btn" id="searchNextBtn" title="Next match (Enter)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="filters-container">
                    <button id="filterSettingsBtn" class="icon-btn" title="Advanced Filters">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                        </svg>
                    </button>
                    <select id="methodFilter" class="filter-select">
                        <option value="ALL">All Methods</option>
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                        <option value="PATCH">PATCH</option>
                        <option value="OPTIONS">OPTIONS</option>
                    </select>
                    <select id="statusFilter" class="filter-select">
                        <option value="ALL">All Status</option>
                        <option value="2xx">2xx Success</option>
                        <option value="3xx">3xx Redirect</option>
                        <option value="4xx">4xx Client Error</option>
                        <option value="5xx">5xx Server Error</option>
                    </select>
                </div>
            </header>

            <!-- Filter Modal -->
            <div id="filterModal" class="modal-overlay">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>History Filter</h2>
                        <button id="closeFilterModal" class="close-modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <!-- In-Scope Domains -->
                        <div class="filter-group">
                            <label>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="2" y1="12" x2="22" y2="12"></line>
                                    <path
                                        d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z">
                                    </path>
                                </svg>
                                In-Scope URLs / Domains
                                <span class="filter-helper">Supports wildcards (e.g. *.example.com)</span>
                            </label>
                            <textarea id="filterInScope" class="filter-textarea"
                                placeholder="example.com&#10;*.google.com&#10;api.mysite.com/v1/*"></textarea>
                        </div>

                        <!-- MIME Types -->
                        <div class="filter-group">
                            <label>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10 9 9 9 8 9"></polyline>
                                </svg>
                                Filter by MIME Type
                            </label>
                            <div class="checkbox-grid">
                                <label class="checkbox-label"><input type="checkbox" name="mime" value="json">
                                    JSON</label>
                                <label class="checkbox-label"><input type="checkbox" name="mime" value="doc">
                                    HTML</label>
                                <label class="checkbox-label"><input type="checkbox" name="mime" value="js"> JS</label>
                                <label class="checkbox-label"><input type="checkbox" name="mime" value="css">
                                    CSS</label>
                                <label class="checkbox-label"><input type="checkbox" name="mime" value="image">
                                    Images</label>
                                <label class="checkbox-label"><input type="checkbox" name="mime" value="font">
                                    Fonts</label>
                                <label class="checkbox-label"><input type="checkbox" name="mime" value="xml">
                                    XML</label>
                                <label class="checkbox-label"><input type="checkbox" name="mime" value="other">
                                    Other</label>
                            </div>
                            <input type="text" id="filterCustomMime" class="filter-input"
                                placeholder="Custom MIME type (e.g. application/pdf)">
                        </div>

                        <!-- Extensions -->
                        <div class="filter-group">
                            <label>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z">
                                    </path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                </svg>
                                Filter by Extension (Exclude)
                            </label>
                            <input type="text" id="filterExtensions" class="filter-input"
                                placeholder="Comma separated (e.g. jpg, png, css, map)">
                        </div>

                        <!-- Static Paths -->
                        <div class="filter-group">
                            <label>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                </svg>
                                Filter by Static Path (Exclude)
                            </label>
                            <input type="text" id="filterStaticPaths" class="filter-input"
                                placeholder="Comma separated (e.g. assets, images, static)">
                        </div>

                        <!-- Regex -->
                        <div class="filter-group">
                            <label>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                                    <path d="M14 2v6h6"></path>
                                    <path d="m3 12.5 5 5"></path>
                                    <path d="m8 12.5-5 5"></path>
                                </svg>
                                Filter by Regex (URL)
                            </label>
                            <input type="text" id="filterRegex" class="filter-input"
                                placeholder="Enter regex pattern...">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="resetFiltersBtn" class="btn btn-danger">Reset Filters</button>
                        <div style="display: flex; gap: 12px;">
                            <button id="cancelFiltersBtn" class="btn btn-secondary">Cancel</button>
                            <button id="applyFiltersBtn" class="btn btn-primary">Apply Filters</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Split View Container -->
            <div class="split-view-container" id="splitViewContainer">
                <!-- List View -->
                <div class="list-pane">
                    <div class="list-header">
                        <div class="col-method">Method</div>
                        <div class="col-url">Name / URL</div>
                        <div class="col-status">Status</div>
                    </div>
                    <div class="list-content" id="apiList">
                        <!-- Items will be injected here -->
                        <div class="empty-state">
                            <div class="empty-icon">üëã</div>
                            <h3>Ready to capture</h3>
                            <p>Requests will appear here automatically</p>
                        </div>
                    </div>
                </div>

                <!-- Resizer -->
                <div class="drag-handle" id="dragHandle"></div>

                <!-- Details Pane -->
                <div class="details-pane" id="detailsPane">
                    <div class="details-empty" id="detailsEmpty">
                        <div class="empty-icon">üëà</div>
                        <p>Select a request to view details</p>
                    </div>
                    <div class="details-content hidden" id="detailsContent">
                        <div class="details-toolbar">
                            <div class="detail-tabs">
                                <button class="detail-tab active" data-view="split">Split</button>
                                <button class="detail-tab" data-view="raw">Raw</button>
                            </div>
                            <div class="detail-actions">
                                <button class="icon-btn" id="copyCurlBtn" title="Copy as cURL">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                </button>
                                <button class="icon-btn" id="sendToRepeaterBtn" title="Send to Repeater">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <polyline points="17 1 21 5 17 9"></polyline>
                                        <path d="M3 11V9a4 4 0 0 1 4-4h14"></path>
                                        <polyline points="7 23 3 19 7 15"></polyline>
                                        <path d="M21 13v2a4 4 0 0 1-4 4H3"></path>
                                    </svg>
                                </button>
                                <button class="icon-btn" id="highlightBtn" title="Highlight">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="m13.5 10.5 4 4" />
                                        <path d="m17.5 6.5 4 4" />
                                        <path d="m8 7 7-7" />
                                        <path d="m16 11-7-7" />
                                        <path d="m19 14-7-7" />
                                        <path d="M22 3 9 16 6 19l-3 5 5-3 3-3 13-13z" />
                                    </svg>
                                </button>
                                <!-- Highlight Menu -->
                                <div class="highlight-menu hidden" id="highlightMenu">
                                    <div class="highlight-option" data-color="red"><span class="dot red"></span> Red
                                    </div>
                                    <div class="highlight-option" data-color="green"><span class="dot green"></span>
                                        Green</div>
                                    <div class="highlight-option" data-color="blue"><span class="dot blue"></span> Blue
                                    </div>
                                    <div class="highlight-option" data-color="yellow"><span class="dot yellow"></span>
                                        Yellow</div>
                                    <div class="highlight-option" data-color="purple"><span class="dot purple"></span>
                                        Purple</div>
                                    <div class="highlight-option" data-color="none">None</div>
                                </div>
                            </div>
                        </div>
                        <div class="details-body" id="detailsBody">
                            <!-- Details injected here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Context Menu -->
            <div id="contextMenu" class="context-menu hidden">
                <div class="context-menu-item" id="ctxSendToRepeater">
                    <span class="context-icon">üîÅ</span> Send to Repeater
                </div>
                <div class="context-menu-item" id="ctxDeleteRequest">
                    <span class="context-icon">üóëÔ∏è</span> Delete Request
                </div>
            </div>

            <!-- Folder Context Menu -->
            <div id="folderContextMenu" class="context-menu hidden">
                <div class="context-menu-item" id="ctxDeleteFolder">
                    <span class="context-icon">üóëÔ∏è</span> Delete Folder
                </div>
            </div>

        </main>
    </div>

    <!-- IndexedDB Storage Module -->
    <script src="../../src/indexeddb.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/httprequestpage.js"></script>
</body>

</html>